name: HuggingFace Keep Alive

on:
  schedule:
    - cron: '0 */6 * * *'
  workflow_dispatch:

jobs:
  trigger:
    runs-on: ubuntu-latest
    env:
      TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
      TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
    
    steps:
      - name: Send start notification
        run: |
          curl -s -X POST "https://api.telegram.org/bot$TELEGRAM_BOT_TOKEN/sendMessage" \
            -d chat_id="$TELEGRAM_CHAT_ID" \
            -d text="üöÄ HuggingFace ‰øùÊ¥ª‰ªªÂä°ÂºÄÂßã"

      - name: Wake up Space 1
        run: |
          url="https://qiyuelian2424-canary-1b-v2-dev.hf.space"
          http_code=$(curl -s -o /dev/null -w "%{http_code}" --max-time 60 "$url")
          curl -s -X POST "https://api.telegram.org/bot$TELEGRAM_BOT_TOKEN/sendMessage" \
            -d chat_id="$TELEGRAM_CHAT_ID" \
            -d text="Space 1: Áä∂ÊÄÅÁ†Å $http_code"
          sleep 30

      - name: Wake up Space 2
        run: |
          url="https://sibacohu-duorenyundong.hf.space"
          http_code=$(curl -s -o /dev/null -w "%{http_code}" --max-time 60 "$url")
          curl -s -X POST "https://api.telegram.org/bot$TELEGRAM_BOT_TOKEN/sendMessage" \
            -d chat_id="$TELEGRAM_CHAT_ID" \
            -d text="Space 2: Áä∂ÊÄÅÁ†Å $http_code"
          sleep 30

      - name: Wake up Space 3
        run: |
          url="https://anikaednerarter50-granite-docling-258m-demo.hf.space"
          http_code=$(curl -s -o /dev/null -w "%{http_code}" --max-time 60 "$url")
          curl -s -X POST "https://api.telegram.org/bot$TELEGRAM_BOT_TOKEN/sendMessage" \
            -d chat_id="$TELEGRAM_CHAT_ID" \
            -d text="Space 3: Áä∂ÊÄÅÁ†Å $http_code"

      - name: Send complete notification
        run: |
          curl -s -X POST "https://api.telegram.org/bot$TELEGRAM_BOT_TOKEN/sendMessage" \
            -d chat_id="$TELEGRAM_CHAT_ID" \
            -d text="‚úÖ HuggingFace ‰øùÊ¥ª‰ªªÂä°ÂÆåÊàê"
